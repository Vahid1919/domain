<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Domain ‚Äî Extension Removed</title>
    <style>
        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            --bg: #0a0a0a;
            --surface: #111111;
            --border: #1f1f1f;
            --fg: #f0f0f0;
            --muted: #707070;
            --accent: #e0e0e0;
            --green: #22c55e;
            --red: #ef4444;
        }

        body {
            background: var(--bg);
            color: var(--fg);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 24px;
        }

        .card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 40px 36px;
            max-width: 480px;
            width: 100%;
            text-align: center;
        }

        .icon {
            font-size: 2.5rem;
            margin-bottom: 20px;
            display: block;
        }

        h1 {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--accent);
        }

        p {
            font-size: 0.95rem;
            color: var(--muted);
            line-height: 1.6;
        }

        .divider {
            border: none;
            border-top: 1px solid var(--border);
            margin: 28px 0;
        }

        .footer {
            font-size: 0.8rem;
            color: var(--muted);
        }

        .footer a {
            color: var(--accent);
            text-decoration: none;
        }

        .footer a:hover {
            text-decoration: underline;
        }
    </style>
</head>

<body>
    <div class="card">
        <span class="icon">üóëÔ∏è</span>
        <h1>Extension Uninstalled</h1>
        <p>
            The Domain extension has been removed from your browser.
            Your limits and blocks are no longer active.
        </p>

        <hr class="divider" />

        <p class="footer">
            Changed your mind?
            <a href="https://github.com/Vahid1919/domain" target="_blank" rel="noopener">
                Reinstall Domain
            </a>
        </p>
    </div>

    <script>
        (async function () {
            // Decode the base64 JSON blob from the fragment
            let to, userName, sid, tid, key;
            try {
                const payload = JSON.parse(atob(location.hash.slice(1)));
                to = payload.to;
                userName = payload.u || "your buddy";
                sid = payload.sid;
                tid = payload.tid;
                key = payload.key;
            } catch {
                return;
            }

            // Nothing to send ‚Äî no partner email or EmailJS not configured
            if (!to || !sid || !tid || !key) return;

            const n = userName.trim() || "your buddy";
            const subject = `üóëÔ∏è ${n} uninstalled their Domain extension`;
            const message = [
                subject,
                "",
                `${n} just uninstalled the Domain extension ‚Äî the one keeping them accountable.`,
                `Their limits and blocks are gone. You know what to do. üëÄ`,
            ].join("\n");

            // Fire and forget ‚Äî no visible feedback to the user
            fetch("https://api.emailjs.com/api/v1.0/email/send", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    service_id: sid,
                    template_id: tid,
                    user_id: key,
                    template_params: {
                        to_email: to,
                        name: n,
                        title: "Extension Uninstalled",
                        subject,
                        message,
                    },
                }),
            }).catch(() => { });
        })();
    </script>
</body>

</html>